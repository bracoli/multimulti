#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f menu-bandwith.sh 
#endif

static  char data [] = 
#define      rlax_z	1
#define      rlax	((&data[0]))
	"\063"
#define      text_z	3419
#define      text	((&data[214]))
	"\201\122\056\255\132\302\373\123\034\120\305\360\223\353\313\042"
	"\361\254\156\053\053\066\112\256\054\374\177\265\330\277\350\131"
	"\022\027\007\154\332\002\300\366\122\205\347\346\161\262\011\143"
	"\137\167\216\212\255\331\070\332\326\270\220\256\167\170\007\211"
	"\220\017\366\152\022\266\141\145\073\110\113\254\373\124\020\132"
	"\314\236\344\171\167\035\124\115\325\344\374\115\135\004\327\356"
	"\023\315\131\045\204\272\212\300\003\326\155\376\053\175\130\367"
	"\033\075\161\223\132\306\341\060\253\335\176\010\341\125\366\365"
	"\043\117\032\250\012\245\150\015\174\326\013\250\123\144\240\157"
	"\241\022\002\374\331\344\055\204\301\253\215\243\001\203\230\045"
	"\323\263\315\336\131\066\353\326\014\367\176\137\133\037\316\375"
	"\062\321\372\013\266\047\217\167\323\034\033\324\240\263\371\164"
	"\147\307\122\300\375\076\226\011\065\025\151\220\064\070\216\146"
	"\012\210\162\300\257\253\015\154\246\306\323\155\303\132\003\002"
	"\147\071\026\204\322\211\071\114\321\017\274\110\032\066\135\002"
	"\130\013\306\220\053\327\302\311\006\164\253\220\126\235\060\050"
	"\363\324\211\116\236\052\224\246\115\371\300\017\232\130\004\063"
	"\041\357\340\046\265\277\267\220\163\043\200\074\057\174\024\011"
	"\370\166\211\214\034\362\044\355\240\320\117\041\065\343\311\147"
	"\010\103\162\072\020\026\015\010\316\254\241\012\035\144\151\300"
	"\076\300\045\000\325\247\040\124\311\130\211\317\131\147\331\021"
	"\113\134\042\170\350\051\137\176\123\204\242\041\157\117\377\333"
	"\012\303\265\035\027\204\314\144\050\022\063\142\303\255\024\304"
	"\213\203\041\127\017\014\264\024\261\254\031\172\347\377\022\323"
	"\042\103\130\257\320\111\022\150\063\074\041\014\065\170\267\015"
	"\331\113\042\077\277\271\264\153\074\303\313\030\364\333\346\147"
	"\044\146\200\116\154\151\071\231\307\111\136\051\046\213\152\205"
	"\217\066\334\310\300\122\316\324\320\003\272\203\144\162\132\314"
	"\023\160\372\034\116\355\332\076\256\266\365\256\064\126\353\001"
	"\230\020\060\103\177\207\161\223\101\100\060\135\117\000\050\024"
	"\024\246\177\234\327\006\134\113\314\026\247\233\245\070\015\336"
	"\111\343\353\044\237\017\153\206\011\042\256\351\171\203\212\151"
	"\330\252\173\054\065\050\324\317\061\113\261\055\024\203\177\140"
	"\026\012\257\117\272\150\175\053\240\350\077\053\336\224\377\364"
	"\031\267\055\035\140\311\161\156\116\334\037\050\051\341\071\364"
	"\223\374\227\256\106\154\370\113\322\067\376\337\262\043\062\045"
	"\254\063\115\375\012\257\000\210\075\335\237\012\332\306\175\035"
	"\126\273\372\301\063\105\016\247\104\221\215\104\241\076\006\146"
	"\170\342\042\231\161\254\333\220\174\146\061\230\304\264\236\101"
	"\105\375\164\330\362\216\110\332\366\140\125\142\163\222\001\363"
	"\021\061\125\317\367\353\217\345\364\266\141\032\172\151\364\061"
	"\074\242\305\253\307\363\142\257\204\111\346\034\377\135\367\216"
	"\260\163\240\131\042\245\255\252\065\067\206\224\310\114\153\237"
	"\227\311\061\312\115\074\023\020\314\333\266\306\061\375\001\132"
	"\157\337\201\315\342\257\024\003\275\377\077\320\274\320\156\245"
	"\131\176\166\004\126\343\362\150\045\042\141\117\312\141\102\177"
	"\021\346\273\000\207\004\341\136\176\012\265\322\036\257\174\225"
	"\106\327\106\315\157\366\214\203\264\355\344\352\364\331\107\113"
	"\045\113\254\242\314\042\270\276\020\252\122\263\250\152\371\275"
	"\377\306\325\147\170\173\210\206\044\262\067\335\362\076\103\011"
	"\351\024\322\251\053\066\350\104\004\346\106\073\322\146\261\233"
	"\257\273\171\377\236\024\327\241\122\034\342\330\066\065\216\137"
	"\130\050\130\244\117\205\020\310\204\057\222\113\046\122\165\215"
	"\343\042\324\361\024\343\000\303\327\063\142\111\123\031\371\241"
	"\346\336\306\250\034\307\377\005\320\114\227\176\076\212\203\311"
	"\355\030\222\005\361\024\325\375\044\130\212\207\306\105\130\246"
	"\261\064\110\012\310\271\372\203\230\336\323\106\017\217\356\203"
	"\162\141\360\321\003\275\272\155\041\015\115\020\031\130\337\107"
	"\227\320\051\171\046\357\317\163\036\235\153\334\150\126\327\333"
	"\341\332\362\170\021\205\310\345\352\161\305\311\272\367\356\150"
	"\354\262\131\243\057\270\020\012\263\043\176\131\104\170\377\152"
	"\225\306\203\152\225\053\367\264\105\002\352\362\023\023\312\025"
	"\176\115\222\205\025\166\311\244\353\257\375\036\147\110\104\320"
	"\112\236\376\070\326\342\374\212\337\140\044\163\054\307\175\344"
	"\076\210\314\311\375\143\302\110\102\044\160\074\135\200\136\200"
	"\030\341\010\034\031\304\246\352\355\012\101\016\046\327\366\251"
	"\156\264\246\017\057\005\030\265\031\364\373\240\322\102\005\353"
	"\310\305\005\333\175\201\210\030\205\263\114\004\107\365\341\246"
	"\053\143\304\071\325\102\064\233\067\053\133\306\335\247\161\062"
	"\041\135\247\241\371\106\031\362\204\313\130\306\234\370\002\374"
	"\023\165\151\215\141\244\060\012\015\177\356\053\267\125\253\016"
	"\302\363\206\056\123\104\332\072\136\165\161\361\321\066\004\231"
	"\030\214\106\333\356\377\316\064\252\066\171\361\310\262\274\256"
	"\025\261\004\246\263\232\166\171\222\301\163\362\225\237\312\341"
	"\300\036\151\173\065\111\025\306\236\003\237\361\122\053\343\116"
	"\151\046\340\014\074\106\112\207\325\347\062\257\212\075\014\142"
	"\363\150\000\070\324\174\032\032\025\267\135\363\140\176\020\006"
	"\012\045\066\330\140\057\223\205\042\110\044\264\262\032\064\254"
	"\247\017\272\111\304\252\305\073\231\077\310\127\355\133\112\126"
	"\145\135\361\050\316\200\331\240\057\162\222\204\211\314\203\066"
	"\161\170\113\327\117\271\254\111\247\272\107\232\362\177\243\124"
	"\276\224\343\144\307\177\244\137\153\146\370\352\012\007\211\040"
	"\342\124\151\370\123\315\136\321\310\133\171\066\124\302\302\007"
	"\344\230\213\270\177\156\123\030\116\113\335\134\365\357\067\122"
	"\055\127\140\166\170\032\046\155\307\267\213\266\247\204\300\221"
	"\066\120\107\121\167\207\352\245\257\160\011\074\256\271\342\273"
	"\050\076\160\142\152\331\346\334\244\053\357\160\112\056\131\125"
	"\114\221\010\132\007\002\244\346\006\176\074\344\032\371\147\306"
	"\262\227\103\172\265\153\310\067\245\016\135\253\371\150\045\263"
	"\255\374\113\204\045\002\337\040\111\173\101\160\226\165\210\262"
	"\050\045\066\224\016\173\325\340\155\173\026\377\336\272\066\211"
	"\164\335\215\156\104\264\256\135\374\314\331\241\175\253\312\272"
	"\011\131\150\066\344\233\310\361\360\033\000\027\205\030\312\051"
	"\357\107\016\324\117\234\001\103\061\176\020\154\267\044\356\025"
	"\214\016\206\130\366\044\116\233\133\327\101\035\064\366\105\050"
	"\172\154\234\315\126\210\171\122\144\277\326\003\272\030\117\065"
	"\005\332\216\374\254\130\025\066\075\155\357\370\332\357\023\011"
	"\333\305\166\353\337\157\151\356\102\302\024\251\236\134\010\254"
	"\074\133\037\166\226\105\315\300\363\043\241\374\374\122\272\147"
	"\106\122\370\147\306\141\064\144\306\347\223\231\111\215\360\260"
	"\350\213\325\365\077\272\054\202\146\320\112\345\306\357\036\300"
	"\257\216\064\263\131\321\212\145\242\032\337\164\204\007\106\306"
	"\330\257\357\205\200\041\155\306\020\277\335\213\072\315\030\313"
	"\023\203\023\257\075\022\244\356\137\041\230\146\006\303\230\273"
	"\307\244\132\063\003\221\344\157\210\114\061\126\221\101\351\131"
	"\055\371\321\133\063\117\025\304\357\165\327\037\211\254\123\262"
	"\036\331\101\122\151\273\266\363\240\146\136\311\022\175\321\367"
	"\112\050\120\201\134\011\041\106\143\215\314\200\066\265\113\277"
	"\111\245\213\001\113\170\062\314\155\026\261\253\027\366\033\243"
	"\106\254\142\210\043\142\247\357\173\315\353\173\243\114\237\106"
	"\237\270\372\024\026\337\244\045\226\372\065\331\044\045\214\214"
	"\141\314\203\231\235\350\105\142\374\222\076\016\203\174\237\031"
	"\105\262\260\166\376\255\040\075\153\143\004\345\006\205\016\070"
	"\167\116\052\264\165\174\101\222\335\017\175\006\223\107\216\341"
	"\233\340\276\125\126\246\252\124\251\325\021\377\102\341\124\051"
	"\211\221\026\006\312\044\324\005\101\077\202\070\341\362\143\062"
	"\202\044\365\126\101\346\035\342\110\335\302\341\237\021\212\320"
	"\020\315\164\330\316\156\351\025\012\044\150\015\270\164\130\233"
	"\132\205\163\124\336\134\054\304\277\167\165\373\241\324\010\176"
	"\330\340\054\145\140\145\264\036\113\364\247\017\204\135\113\375"
	"\261\334\175\072\040\322\126\270\075\060\306\166\131\020\231\343"
	"\127\147\007\224\053\045\233\163\032\245\347\370\014\307\101\272"
	"\275\107\332\131\254\017\030\037\346\301\040\064\347\104\352\135"
	"\262\263\276\106\236\241\004\075\175\307\103\277\217\236\317\052"
	"\331\173\016\315\253\226\037\220\100\314\100\057\047\050\106\301"
	"\127\225\215\111\303\333\002\313\236\237\104\023\275\160\107\320"
	"\177\313\244\203\344\150\016\315\234\030\143\075\211\143\302\273"
	"\140\111\254\272\101\307\210\043\017\325\152\304\143\341\275\131"
	"\105\027\263\037\152\320\155\151\314\157\357\103\074\033\266\057"
	"\204\314\066\077\300\230\110\053\260\327\324\243\023\046\343\142"
	"\105\044\252\200\044\141\225\112\026\311\320\013\252\336\167\062"
	"\254\111\252\051\354\070\227\031\041\176\246\174\243\254\041\270"
	"\100\312\367\305\155\220\111\336\172\067\305\347\005\013\347\265"
	"\336\373\177\103\357\354\067\066\223\127\303\101\277\230\014\155"
	"\202\015\226\015\275\112\024\251\357\001\261\146\265\302\027\071"
	"\057\167\267\226\327\201\005\264\370\321\355\046\037\231\051\351"
	"\311\216\170\343\363\256\370\345\067\270\042\337\324\165\350\204"
	"\026\315\134\301\310\016\041\025\236\233\001\025\253\357\011\361"
	"\232\364\147\167\140\057\331\204\140\016\105\211\131\033\313\150"
	"\276\160\123\327\222\343\201\140\062\012\336\333\267\365\027\110"
	"\350\245\302\062\236\364\005\103\151\215\237\360\332\121\121\352"
	"\104\117\323\323\172\243\321\057\036\141\316\205\030\242\300\251"
	"\212\104\105\004\146\176\313\255\057\367\074\204\337\054\063\275"
	"\057\351\351\260\011\266\277\053\036\131\062\055\020\142\235\140"
	"\325\373\230\373\125\002\250\235\205\213\122\215\307\146\222\255"
	"\344\356\011\014\007\136\266\073\121\056\355\016\224\241\214\032"
	"\350\207\200\241\333\151\145\145\042\212\202\045\012\030\102\274"
	"\070\036\031\220\331\202\024\222\327\054\361\261\203\107\016\037"
	"\114\203\052\042\215\016\062\166\067\366\032\060\346\064\253\063"
	"\321\243\100\224\100\047\037\055\343\273\061\354\162\356\245\171"
	"\172\067\204\334\012\073\076\037\113\200\042\131\074\352\015\342"
	"\033\071\310\236\047\126\300\260\021\201\223\076\277\371\231\311"
	"\340\364\323\310\336\042\225\054\161\266\152\112\230\213\213\251"
	"\255\026\230\002\217\156\366\165\225\124\305\224\316\047\042\267"
	"\271\122\043\023\006\220\064\362\204\357\001\250\023\270\225\147"
	"\360\152\042\343\362\040\230\327\360\006\375\166\301\115\025\242"
	"\135\127\205\221\222\135\020\021\265\276\241\264\122\067\270\077"
	"\101\011\360\225\215\076\322\000\175\135\302\060\144\211\217\045"
	"\365\062\006\266\041\315\303\124\323\204\045\145\314\070\330\012"
	"\155\132\362\102\222\222\206\237\155\300\300\025\057\177\230\263"
	"\170\264\023\331\342\332\373\015\053\253\215\310\147\122\173\315"
	"\275\244\303\016\060\155\014\163\236\377\045\061\023\054\142\175"
	"\150\055\061\205\372\133\100\037\300\041\325\037\173\070\005\277"
	"\173\344\276\327\172\040\330\306\237\030\134\022\004\337\075\272"
	"\107\275\156\327\362\372\235\215\257\040\076\130\163\156\031\367"
	"\255\051\103\042\003\035\171\205\333\175\016\165\246\014\057\241"
	"\300\123\074\030\146\307\241\232\370\023\221\013\367\174\163\001"
	"\217\030\220\207\100\144\376\155\250\354\367\033\176\366\310\217"
	"\370\255\145\051\132\371\043\350\147\115\323\067\317\143\160\143"
	"\274\166\060\142\322\230\066\251\173\037\005\005\200\241\242\205"
	"\366\162\050\065\034\221\003\023\354\075\133\307\222\275\237\206"
	"\313\277\224\261\163\102\340\306\306\132\354\156\163\114\372\110"
	"\314\135\142\006\351\240\125\234\152\341\325\274\077\254\035\111"
	"\340\021\052\222\130\251\212\000\350\200\034\033\277\212\045\357"
	"\151\206\170\031\333\261\010\147\152\021\137\143\023\140\250\172"
	"\011\207\014\055\016\161\141\315\047\120\125\116\017\123\365\166"
	"\150\073\226\346\056\154\074\315\034\043\131\052\207\174\045\306"
	"\233\232\122\265\135\175\172\176\102\245\033\205\135\253\374\154"
	"\047\034\263\326\311\137\340\255\132\250\165\253\115\215\371\271"
	"\311\344\220\157\030\271\164\357\272\055\036\323\022\261\120\172"
	"\344\261\307\206\376\177\312\155\150\314\174\305\131\261\207\035"
	"\240\101\024\236\231\332\212\266\260\372\103\046\362\043\122\143"
	"\231\042\032\173\243\220\107\172\322\301\244\210\001\113\160\377"
	"\276\141\131\205\376\040\347\327\107\253\125\055\156\316\211\372"
	"\234\266\233\015\050\202\035\245\325\204\006\364\072\042\334\265"
	"\235\175\162\336\273\300\375\041\377\051\302\131\301\217\201\300"
	"\374\044\266\012\376\167\010\344\042\343\155\041\130\065\350\344"
	"\077\220\030\176\241\304\210\316\010\014\067\306\256\315\155\300"
	"\376\173\322\125\372\300\112\241\007\313\134\103\115\236\211\200"
	"\073\070\271\220\226\300\156\063\117\306\257\074\021\155\066\266"
	"\303\151\131\365\242\102\026\134\022\275\327\056\115\276\351\263"
	"\123\310\301\022\125\244\354\040\244\201\211\347\110\255\260\033"
	"\206\154\304\132\132\073\334\250\201\154\062\301\353\177\377\144"
	"\171\125\074\056\177\356\351\137\335\225\034\156\140\221\075\041"
	"\163\243\155\033\126\214\317\155\241\264\164\324\237\374\372\117"
	"\225\135\170\100\217\177\224\170\237\220\140\230\172\064\367\110"
	"\323\265\301\030\340\325\040\254\005\005\230\065\100\253\026\014"
	"\327\321\230\070\104\123\164\172\142\230\234\276\223\166\305\112"
	"\122\201\113\071\043\055\017\311\154\125\277\101\041\240\112\176"
	"\155\233\151\346\314\120\343\375\321\247\012\101\023\342\302\102"
	"\052\160\236\204\055\243\154\012\163\047\242\301\012\306\012\040"
	"\011\037\373\333\155\265\054\325\323\243\124\120\361\015\334\170"
	"\166\371\345\324\164\144\046\333\133\165\304\262\237\057\016\250"
	"\244\170\243\101\267\351\235\345\363\303\332\372\123\261\236\210"
	"\311\257\026\260\175\345\012\321\017\361\270\007\035\141\245\315"
	"\033\056\053\070\341\007\341\236\236\143\346\130\102\022\262\247"
	"\220\133\155\014\073\046\365\124\201\071\106\226\326\322\123\015"
	"\126\132\166\375\242\175\172\241\303\226\252\035\102\224\072\153"
	"\013\000\304\173\215\141\337\325\140\256\241\317\075\160\207\272"
	"\107\016\307\167\150\155\063\217\344\273\234\136\271\346\165\012"
	"\224\173\065\227\354\131\255\317\047\114\060\032\100\360\002\320"
	"\063\331\113\122\074\071\121\266\170\331\107\214\043\373\336\021"
	"\166\052\101\177\360\320\300\254\056\227\036\032\070\316\004\163"
	"\060\013\163\371\055\045\035\221\366\055\344\021\124\345\247\307"
	"\213\354\054\331\333\141\040\250\011\024\376\324\163\272\060\006"
	"\376\143\101\010\106\350\037\025\231\177\166\114\221\236\260\053"
	"\223\367\153\150\004\162\345\112\156\214\047\357\375\361\370\236"
	"\116\207\377\276\356\125\353\147\051\300\301\231\033\127\061\226"
	"\345\105\374\210\111\103\134\171\112\070\367\002\165\246\034\067"
	"\211\337\023\221\325\010\360\031\237\221\156\053\330\222\144\202"
	"\120\246\115\146\360\155\122\056\357\332\014\006\132\252\345\345"
	"\051\074\341\312\006\214\062\130\061\177\171\226\376\260\116\017"
	"\137\274\006\360\304\162\257\337\022\030\170\257\062\076\307\205"
	"\025\200\375\047\171\124\325\122\210\210\114\244\230\122\071\201"
	"\072\363\212\164\162\206\006\210\120\301\267\123\060\052\171\121"
	"\174\002\103\041\344\260\112\332\214\077\361\036\056\013\050\131"
	"\254\377\226\006\047\024\304\237\143\253\040\037\061\170\024\037"
	"\002\067\202\037\123\127\300\006\121\064\155\030\207\056\025\305"
	"\304\037\372\332\210\213\016\300\031\165\312\241\350\212\121\352"
	"\302\324\011\025\053\311\034\174\375\212\225\205\270\252\113\175"
	"\311\105\127\122\321\146\022\352\334\335\214\304\150\335\256\052"
	"\261\270\100\335\201\134\132\177\347\357\004\237\232\117\035\144"
	"\225\165\266\146\334\311\121\271\246\335\175\017\273\054\071\155"
	"\345\172\113\146\326\245\345\275\224\352\135\056\072\173\222\320"
	"\360\111\067\315\022\210\206\271\146\004\310\042\061\002\220\026"
	"\174\333\174\123\200\142\021\024\115\157\103\207\352\326\130\333"
	"\037\217\250\061\030\057\353\177\063\263\241\144\266\062\172\062"
	"\015\367\205\215\131\227\242\247\006\345\057"
#define      chk2_z	19
#define      chk2	((&data[3807]))
	"\314\333\027\043\024\364\036\063\247\113\000\346\271\375\225\176"
	"\340\254\161\067\326\274\165\014"
#define      date_z	1
#define      date	((&data[3828]))
	"\277"
#define      opts_z	1
#define      opts	((&data[3829]))
	"\265"
#define      inlo_z	3
#define      inlo	((&data[3830]))
	"\314\225\115"
#define      tst1_z	22
#define      tst1	((&data[3837]))
	"\220\255\032\035\126\106\270\164\245\006\342\244\104\047\371\006"
	"\344\135\041\141\164\003\225\350\145\322\007\261\300"
#define      tst2_z	19
#define      tst2	((&data[3865]))
	"\336\251\142\317\031\065\234\030\212\077\141\102\010\151\051\135"
	"\367\231\370\120\025\304\146\165\075"
#define      chk1_z	22
#define      chk1	((&data[3892]))
	"\255\216\102\134\146\226\246\225\074\170\241\263\257\077\334\336"
	"\253\111\162\233\056\025\162\335\220\224\353\356"
#define      pswd_z	256
#define      pswd	((&data[3956]))
	"\060\130\344\301\006\377\337\016\261\237\275\151\105\234\023\247"
	"\002\210\344\177\163\057\054\001\161\210\147\137\066\011\257\146"
	"\142\224\050\150\224\007\167\105\246\127\325\220\320\026\344\313"
	"\221\162\336\160\010\001\165\104\214\340\240\335\166\310\232\232"
	"\316\023\060\277\351\147\366\221\277\313\041\220\342\006\133\164"
	"\170\072\344\200\074\132\305\310\073\146\245\261\056\077\114\375"
	"\123\174\274\074\343\262\315\243\176\357\063\140\365\217\325\156"
	"\311\271\357\006\024\265\316\117\033\164\001\111\264\115\106\007"
	"\311\003\104\255\265\022\120\063\002\203\224\370\023\151\146\335"
	"\043\125\343\070\013\262\207\046\046\211\160\332\327\266\342\240"
	"\272\047\116\157\071\237\243\074\043\067\064\066\241\232\023\305"
	"\360\366\375\374\251\205\042\317\017\222\252\346\111\214\207\003"
	"\263\325\163\355\164\026\052\230\116\136\316\357\371\342\265\352"
	"\331\262\346\202\070\010\121\107\233\373\055\345\210\265\350\074"
	"\212\133\052\377\162\124\230\300\262\146\260\254\110\145\226\041"
	"\030\175\243\120\206\365\230\041\360\305\006\170\173\357\265\006"
	"\112\337\006\274\063\236\175\346\004\055\222\115\222\051\157\252"
	"\246\022\373\054\010\223\115\370\131\124\161\324\103\046\332\216"
	"\005\340\113\071\176\310\037\203\365\064\257\354\320\302\224\323"
	"\113\171\122\276\250\176\300\031\007\050\170\075\062"
#define      shll_z	10
#define      shll	((&data[4233]))
	"\275\022\254\104\210\275\221\100\307\027\170\314"
#define      msg1_z	65
#define      msg1	((&data[4249]))
	"\164\227\172\251\106\127\130\364\034\050\050\140\345\314\100\007"
	"\100\111\134\100\270\014\143\372\027\155\031\252\145\061\126\107"
	"\152\176\160\373\103\357\347\375\332\017\242\343\233\270\222\015"
	"\324\175\220\260\165\175\376\170\022\164\345\152\137\160\270\045"
	"\131\174\356\205\326\322\147\172\011\373\115\124\164\240\023\034"
	"\036\323\066\046"
#define      xecc_z	15
#define      xecc	((&data[4330]))
	"\055\327\051\342\237\270\360\200\335\202\071\251\357\010\155\017"
	"\014\010"
#define      lsto_z	1
#define      lsto	((&data[4346]))
	"\113"
#define      msg2_z	19
#define      msg2	((&data[4351]))
	"\063\174\044\335\170\075\214\041\062\171\122\053\031\217\163\354"
	"\374\132\034\230\276\367\212\303\213\127"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
