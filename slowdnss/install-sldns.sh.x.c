#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f install-sldns.sh 
#endif

static  char data [] = 
#define      tst1_z	22
#define      tst1	((&data[4]))
	"\110\027\041\077\162\071\217\202\264\112\372\375\174\244\146\321"
	"\136\025\042\262\123\265\132\306\215\231"
#define      shll_z	10
#define      shll	((&data[27]))
	"\220\354\362\212\144\350\025\261\056\160\271\207\003"
#define      text_z	4205
#define      text	((&data[493]))
	"\240\307\375\333\333\325\356\156\175\077\372\222\357\276\073\155"
	"\152\103\265\201\144\364\266\316\245\107\125\251\026\304\270\267"
	"\213\266\222\146\214\201\325\011\300\320\233\260\216\327\035\371"
	"\032\323\173\177\310\062\115\156\171\243\030\220\150\320\107\363"
	"\207\332\132\023\133\060\034\034\000\270\314\216\220\352\210\252"
	"\276\003\051\206\065\167\364\257\032\014\077\203\335\207\166\144"
	"\141\321\167\275\001\224\331\001\115\246\220\335\221\030\210\117"
	"\034\261\325\121\051\312\000\104\327\100\307\264\310\076\030\052"
	"\017\220\347\020\045\301\022\162\150\243\120\371\273\330\111\330"
	"\212\036\051\263\351\052\370\300\152\277\164\063\375\215\135\015"
	"\036\104\036\104\006\060\266\156\323\007\147\217\337\260\147\152"
	"\317\221\036\271\273\026\171\046\325\356\131\323\173\266\340\232"
	"\373\376\336\001\057\225\157\003\234\327\222\174\210\372\347\127"
	"\213\005\020\107\033\212\155\361\170\307\305\364\175\245\217\171"
	"\244\155\173\323\003\352\327\240\302\152\035\112\144\004\242\360"
	"\011\263\070\045\076\245\027\266\155\334\253\353\202\072\144\046"
	"\250\337\372\254\312\321\114\214\073\151\327\240\155\172\221\167"
	"\055\311\235\154\157\264\042\334\220\316\307\023\011\054\071\261"
	"\014\064\135\326\006\252\143\102\023\073\342\201\265\164\371\343"
	"\075\226\117\255\113\162\212\334\101\122\357\112\176\051\374\213"
	"\135\132\141\143\004\305\245\030\000\210\231\266\375\223\232\073"
	"\051\352\350\165\135\162\121\236\305\100\350\104\151\344\317\306"
	"\076\061\052\103\366\320\133\367\131\365\256\126\210\110\221\261"
	"\063\172\046\220\355\170\056\262\270\026\366\041\373\306\350\072"
	"\367\023\175\356\343\330\345\075\315\224\223\125\335\045\007\020"
	"\237\056\240\214\246\316\076\137\345\065\201\341\373\152\033\363"
	"\175\231\341\141\162\307\236\100\133\062\226\070\127\235\110\366"
	"\314\351\203\163\270\302\322\235\367\124\177\363\276\232\347\073"
	"\064\310\235\246\217\074\254\132\324\265\261\205\004\040\074\342"
	"\237\027\074\356\357\147\321\240\206\016\305\241\133\246\355\265"
	"\136\015\356\053\152\205\037\155\126\373\067\002\000\307\252\240"
	"\336\105\153\345\227\236\254\354\152\232\232\347\274\131\132\174"
	"\120\142\346\276\172\247\100\125\022\120\006\101\344\306\047\123"
	"\030\145\314\224\301\202\020\376\347\126\376\062\305\054\232\042"
	"\227\034\144\110\144\327\255\174\210\134\164\313\275\173\240\051"
	"\021\266\375\305\067\057\050\356\234\202\106\326\027\146\335\105"
	"\226\041\255\224\003\254\226\215\050\265\163\054\175\076\034\140"
	"\115\010\242\034\133\233\160\165\113\005\116\112\033\116\004\100"
	"\231\243\164\102\172\301\043\321\155\343\340\140\261\065\160\177"
	"\052\303\305\032\107\046\056\075\304\324\366\332\375\302\022\253"
	"\042\006\066\152\070\157\017\275\130\071\017\055\104\166\032\035"
	"\221\102\241\241\336\056\062\047\346\100\110\356\133\035\264\343"
	"\137\132\215\226\042\325\057\111\153\104\331\003\226\370\207\366"
	"\202\064\304\344\040\053\004\021\133\067\232\143\254\153\137\255"
	"\032\131\102\031\166\017\172\052\111\273\062\202\243\301\032\115"
	"\017\374\001\341\157\125\057\027\260\344\012\341\013\305\305\167"
	"\113\156\116\317\070\256\342\257\366\006\050\333\220\255\140\152"
	"\060\027\013\206\277\245\052\344\266\217\131\376\054\230\310\336"
	"\164\216\143\166\271\337\044\053\307\361\070\302\020\166\110\120"
	"\353\341\355\157\006\273\052\075\303\067\331\243\034\316\232\365"
	"\364\166\025\134\113\126\342\143\271\110\243\226\144\330\261\031"
	"\366\323\216\345\316\305\212\124\161\156\320\116\207\235\101\137"
	"\220\025\033\150\172\112\005\372\025\307\037\041\060\156\370\322"
	"\326\014\251\210\327\055\225\045\214\374\225\156\245\375\320\124"
	"\265\333\336\145\043\022\125\146\241\020\313\161\052\323\066\144"
	"\062\023\361\166\371\225\153\216\363\246\307\175\356\241\004\144"
	"\157\223\061\052\121\204\065\332\152\376\267\030\206\105\165\320"
	"\122\261\045\163\043\043\123\364\125\000\354\021\017\106\011\046"
	"\310\142\055\113\305\060\236\310\236\224\306\305\214\274\360\226"
	"\212\250\122\016\210\102\245\333\220\320\014\261\216\265\310\223"
	"\275\321\306\154\053\052\137\362\222\311\317\113\314\251\310\031"
	"\247\373\076\350\370\202\304\066\015\303\347\126\146\271\206\127"
	"\143\127\361\273\131\077\226\255\206\273\236\343\233\175\201\311"
	"\262\250\137\052\276\107\211\203\171\253\304\022\263\032\363\320"
	"\144\015\203\034\036\160\151\031\152\164\365\255\210\150\067\144"
	"\130\165\175\010\363\340\206\161\217\265\364\324\113\120\225\347"
	"\035\300\340\313\104\146\153\060\273\043\150\106\017\131\151\304"
	"\020\170\211\000\010\247\362\300\230\047\361\073\371\207\321\167"
	"\325\272\304\265\032\316\066\067\144\241\067\263\374\066\036\254"
	"\011\215\246\346\022\255\307\147\123\057\301\135\230\027\320\061"
	"\016\112\364\073\157\331\374\262\237\143\320\133\313\077\057\265"
	"\316\034\213\171\344\254\216\373\163\334\244\107\015\365\162\352"
	"\027\040\226\203\220\111\356\063\101\135\270\224\223\360\241\333"
	"\323\243\122\120\137\337\012\305\110\126\107\325\011\047\343\272"
	"\000\011\076\051\145\053\224\064\043\044\041\377\007\350\275\011"
	"\202\235\162\372\326\121\176\367\174\115\261\174\233\207\223\227"
	"\215\077\320\233\264\147\164\277\006\174\267\023\135\373\270\277"
	"\213\353\254\027\137\230\327\336\106\005\202\022\367\160\303\147"
	"\162\302\076\236\247\225\115\112\152\311\123\034\227\272\324\104"
	"\365\064\065\221\150\003\213\157\362\013\223\204\254\061\030\064"
	"\253\237\327\271\273\034\016\210\205\164\270\234\125\323\335\330"
	"\170\177\210\002\307\013\340\026\156\005\242\211\235\142\043\317"
	"\031\234\034\124\026\034\237\367\010\156\117\343\067\036\123\362"
	"\155\263\376\213\326\020\022\066\055\212\073\330\355\070\162\047"
	"\125\100\327\105\043\233\011\211\324\020\323\071\335\307\171\307"
	"\351\152\021\041\134\246\004\027\041\137\136\370\252\152\111\123"
	"\107\155\135\320\273\032\263\155\111\156\354\131\247\214\224\170"
	"\255\122\172\046\102\222\337\077\301\157\276\314\223\301\244\305"
	"\324\311\000\175\171\331\132\203\026\006\225\061\075\326\002\261"
	"\014\123\353\270\147\116\121\161\223\270\276\332\330\042\371\206"
	"\207\260\120\241\227\165\351\107\277\126\231\121\314\326\140\055"
	"\361\335\302\065\035\313\345\173\333\025\247\047\361\120\324\262"
	"\023\203\177\024\305\355\012\224\107\126\367\127\263\102\343\033"
	"\267\224\373\157\377\236\134\313\356\373\120\007\005\056\223\024"
	"\216\365\367\356\362\150\372\352\110\143\157\304\163\016\122\137"
	"\040\247\124\167\113\063\210\136\266\023\107\274\374\023\264\311"
	"\163\250\054\175\333\111\072\357\030\063\342\370\263\074\346\055"
	"\143\324\052\306\207\156\040\274\066\112\352\265\340\055\055\217"
	"\366\266\243\336\172\150\231\255\032\133\201\320\050\377\212\243"
	"\137\107\076\041\047\273\121\027\215\317\216\230\106\261\042\177"
	"\047\230\307\114\023\000\030\023\233\344\375\135\261\270\113\001"
	"\045\313\110\164\162\042\014\265\116\022\141\016\166\255\317\001"
	"\237\123\332\030\355\325\012\110\031\264\100\154\320\242\162\116"
	"\342\055\244\333\045\322\131\317\251\302\334\025\267\071\205\157"
	"\132\344\027\321\332\170\053\156\361\300\224\200\052\351\221\137"
	"\073\121\026\230\014\126\344\027\163\240\177\242\155\263\107\052"
	"\031\175\241\177\175\302\224\224\332\056\274\352\163\356\275\361"
	"\143\002\200\206\160\164\103\035\031\150\325\200\057\130\161\074"
	"\173\374\332\326\174\206\337\175\073\061\205\347\276\166\361\130"
	"\203\104\342\370\362\237\235\223\005\055\363\171\064\157\317\302"
	"\020\317\176\064\301\122\042\043\247\127\335\213\254\171\261\166"
	"\152\123\341\206\360\314\000\226\100\272\347\054\233\260\117\353"
	"\162\235\326\304\175\237\070\202\104\223\144\100\073\211\301\203"
	"\120\270\116\160\271\024\175\370\343\150\156\024\362\317\356\226"
	"\161\140\105\312\132\063\344\214\122\234\135\230\350\114\230\033"
	"\305\227\363\332\153\363\003\364\104\355\155\147\265\217\063\244"
	"\257\326\347\004\112\163\130\030\161\002\012\117\047\317\257\062"
	"\051\307\216\136\215\303\270\373\174\144\053\304\107\143\066\202"
	"\076\026\017\057\073\310\167\125\372\236\113\263\247\355\206\117"
	"\264\070\123\043\367\102\304\241\130\004\334\314\352\050\244\010"
	"\053\210\254\220\036\035\262\247\143\346\064\336\330\047\344\337"
	"\135\227\277\352\331\126\363\112\340\125\045\130\171\046\165\270"
	"\044\363\207\021\307\164\072\057\323\240\015\332\151\335\323\346"
	"\132\015\033\117\230\165\333\057\216\355\020\045\004\114\171\146"
	"\251\033\101\223\377\005\213\066\054\306\043\135\126\135\162\035"
	"\042\153\147\334\335\274\130\076\240\130\274\161\160\366\100\200"
	"\143\370\044\105\227\232\141\064\114\131\062\246\166\246\070\222"
	"\201\265\026\044\053\223\142\147\172\035\342\334\057\261\375\273"
	"\066\156\155\050\032\161\067\006\372\264\344\234\356\307\241\250"
	"\077\364\176\337\331\170\032\263\352\061\375\067\222\115\377\356"
	"\052\024\245\050\322\254\024\252\352\221\165\215\320\341\205\034"
	"\321\362\207\355\123\263\235\073\052\107\351\000\324\133\107\133"
	"\236\363\354\236\300\137\020\363\062\377\134\027\335\203\353\036"
	"\170\001\221\154\017\010\213\062\072\106\166\265\227\370\364\106"
	"\332\066\361\341\202\173\313\327\006\337\016\176\231\126\306\272"
	"\354\036\155\152\001\075\162\210\130\370\225\054\326\304\264\154"
	"\373\056\361\040\315\225\065\116\301\052\221\150\221\252\251\164"
	"\222\044\222\174\066\051\052\262\337\061\335\247\257\277\216\142"
	"\123\042\375\265\177\101\041\114\032\351\200\317\146\075\246\026"
	"\247\144\364\103\265\162\160\175\211\116\041\220\123\301\271\074"
	"\153\242\320\077\036\254\270\040\071\010\017\232\154\226\203\100"
	"\311\303\067\307\226\362\300\214\216\262\362\307\116\351\253\147"
	"\370\101\351\162\256\266\155\145\236\167\036\074\303\355\300\050"
	"\252\264\223\033\145\303\143\304\260\252\066\124\177\356\261\243"
	"\145\260\031\353\347\155\301\005\216\360\204\120\154\162\176\000"
	"\067\247\266\016\065\166\144\052\107\245\344\003\066\044\033\354"
	"\122\241\333\115\347\147\336\026\124\002\303\042\336\267\121\270"
	"\312\335\376\322\223\215\062\325\222\236\120\001\353\125\002\057"
	"\147\376\175\271\265\075\271\217\203\124\326\227\023\217\350\211"
	"\017\001\001\047\302\357\137\300\000\235\057\142\275\360\305\025"
	"\011\322\341\156\360\024\250\263\032\140\114\100\171\140\061\376"
	"\071\232\072\370\341\347\220\004\202\113\001\344\337\021\200\204"
	"\164\073\003\265\155\212\303\326\125\326\320\353\222\010\154\344"
	"\063\222\177\332\171\151\254\037\326\322\006\342\111\141\113\217"
	"\067\214\223\205\033\117\026\315\027\141\262\365\077\321\177\263"
	"\255\310\055\364\232\252\150\200\344\307\235\302\335\265\312\106"
	"\065\122\076\136\027\067\221\356\046\102\274\303\333\013\141\250"
	"\216\077\366\172\332\162\361\117\257\222\125\132\306\307\074\050"
	"\341\276\127\224\024\201\125\220\016\121\051\323\346\373\021\244"
	"\241\050\170\031\362\350\333\335\300\210\370\232\065\067\307\225"
	"\333\245\120\002\100\146\245\001\147\012\067\325\161\311\046\170"
	"\171\100\261\367\330\131\131\346\367\357\354\335\004\320\032\215"
	"\145\221\375\266\343\345\272\005\335\127\304\346\133\033\112\057"
	"\070\042\341\021\233\306\150\367\017\267\134\214\311\244\147\262"
	"\167\000\104\110\346\005\020\224\223\161\131\054\247\060\353\120"
	"\132\045\042\175\241\046\031\015\242\210\110\313\373\124\214\275"
	"\136\252\123\311\255\176\277\226\342\166\053\377\147\003\375\121"
	"\160\067\341\141\336\046\276\323\334\121\112\345\040\105\144\337"
	"\234\023\264\017\046\360\044\213\176\105\367\323\012\205\163\253"
	"\302\375\376\351\123\200\110\351\310\114\117\014\231\051\022\367"
	"\134\304\125\216\310\151\053\270\276\162\021\321\206\250\202\072"
	"\305\043\263\177\347\247\202\335\353\362\222\174\135\025\127\306"
	"\152\247\057\351\016\211\164\367\042\301\264\145\217\337\154\103"
	"\223\354\067\020\273\071\066\037\061\270\264\151\345\210\075\354"
	"\277\254\255\161\057\151\002\204\303\076\104\175\313\234\276\231"
	"\265\366\356\327\127\241\263\223\200\155\233\350\373\153\370\216"
	"\022\016\365\257\006\027\124\373\225\376\011\347\075\064\251\117"
	"\322\246\317\056\122\031\164\336\026\275\211\005\217\050\003\345"
	"\142\101\111\331\014\315\320\311\032\354\035\014\131\212\361\104"
	"\250\236\025\170\146\157\006\065\324\073\160\217\262\022\156\124"
	"\064\374\000\062\214\026\116\061\341\047\043\151\107\333\140\171"
	"\172\152\301\337\237\345\017\172\022\067\156\210\251\041\103\174"
	"\117\307\332\175\142\232\242\361\015\220\366\244\265\201\301\233"
	"\147\120\045\134\230\260\142\323\357\151\243\022\126\023\303\062"
	"\027\065\352\340\133\002\205\070\272\045\312\231\316\227\375\251"
	"\206\053\125\021\130\206\044\026\275\126\357\220\366\217\164\377"
	"\070\316\061\307\040\006\321\142\051\242\246\022\324\120\343\077"
	"\023\175\206\171\001\352\150\124\064\045\256\204\350\366\321\262"
	"\237\105\211\070\045\321\133\256\140\153\203\220\356\124\164\131"
	"\157\316\226\366\240\303\265\343\011\102\156\177\371\356\053\233"
	"\111\135\112\056\031\312\157\225\200\276\132\351\104\255\217\362"
	"\372\204\101\273\216\030\372\233\023\254\003\132\246\156\157\065"
	"\140\260\225\366\012\062\152\024\214\020\162\236\017\311\145\037"
	"\067\133\030\131\370\017\164\130\035\116\253\030\106\351\343\114"
	"\363\353\257\277\216\105\052\045\207\372\134\253\011\233\132\145"
	"\241\076\130\050\057\163\314\203\144\173\153\231\351\260\265\373"
	"\276\204\134\356\026\031\353\260\016\365\301\231\312\041\062\135"
	"\372\175\370\070\010\356\201\217\243\366\130\042\060\071\014\222"
	"\225\142\116\123\035\137\174\202\056\005\301\237\204\026\150\164"
	"\263\177\126\016\315\177\024\342\240\122\162\011\352\012\052\045"
	"\355\273\053\007\374\117\273\071\223\240\255\002\103\123\315\362"
	"\051\025\335\121\041\264\334\302\015\337\003\114\313\307\356\016"
	"\256\153\273\021\347\012\066\320\023\121\062\204\321\121\202\017"
	"\101\120\345\101\144\275\050\337\056\251\377\050\177\146\336\032"
	"\205\002\160\174\376\030\156\360\137\074\065\077\275\275\273\211"
	"\374\122\076\130\001\166\177\134\000\213\325\325\016\217\014\331"
	"\343\373\143\305\224\237\167\110\020\204\114\143\130\230\133\226"
	"\244\262\325\024\245\052\223\267\134\223\274\023\300\021\044\027"
	"\252\131\205\070\037\113\142\126\052\011\125\310\205\211\177\045"
	"\302\176\335\075\044\227\051\204\304\310\134\372\176\270\111\304"
	"\357\271\353\131\146\357\056\354\371\233\061\002\254\231\165\337"
	"\221\150\323\013\155\102\102\174\167\107\131\354\112\131\165\257"
	"\230\136\024\311\274\270\332\161\014\050\035\152\110\010\130\256"
	"\052\203\033\333\206\327\044\357\357\161\154\143\037\205\127\375"
	"\377\337\056\273\122\074\157\216\106\145\027\302\072\220\354\064"
	"\170\045\312\120\076\123\361\027\173\127\132\276\165\012\121\000"
	"\027\102\274\243\226\010\227\352\041\145\025\343\335\006\010\100"
	"\207\074\311\072\116\225\317\137\334\014\375\250\244\063\137\141"
	"\315\177\017\207\353\250\021\165\220\214\161\064\223\203\251\063"
	"\254\370\045\001\112\324\303\165\266\012\370\130\133\155\236\356"
	"\170\167\215\067\340\303\031\074\306\114\164\302\352\237\026\145"
	"\257\345\253\016\304\134\104\275\015\025\025\017\367\171\162\221"
	"\112\330\031\006\062\063\125\003\075\200\266\337\223\014\226\142"
	"\127\270\041\365\031\067\120\130\033\162\057\176\075\244\164\134"
	"\153\253\310\245\011\176\031\163\270\135\241\117\111\220\043\311"
	"\052\237\030\261\272\145\026\323\062\006\252\077\011\024\014\317"
	"\211\361\224\240\032\034\100\227\325\237\306\372\140\025\167\106"
	"\151\254\047\255\237\051\202\001\005\302\123\140\072\111\054\006"
	"\027\213\367\212\244\276\372\232\350\176\223\263\305\074\111\161"
	"\042\232\020\114\142\276\142\364\254\312\274\047\133\220\324\331"
	"\113\065\216\016\242\037\303\026\032\143\066\347\354\065\202\013"
	"\013\115\204\060\163\361\112\110\336\034\260\120\343\013\343\257"
	"\333\225\045\144\210\054\147\213\265\053\061\366\326\365\120\271"
	"\015\231\371\223\001\273\161\305\367\042\015\264\235\007\060\267"
	"\063\111\360\040\256\350\064\314\006\325\367\115\036\343\271\342"
	"\334\305\055\226\145\172\223\324\175\155\103\346\230\227\012\321"
	"\112\241\011\316\024\072\164\076\322\025\070\171\046\331\275\062"
	"\052\235\150\100\205\252\121\076\241\145\172\275\267\160\315\275"
	"\300\003\154\360\166\367\333\314\102\335\365\110\233\363\050\316"
	"\372\316\307\167\206\022\356\024\143\144\127\013\242\252\306\342"
	"\357\213\113\110\022\021\007\202\122\203\323\065\075\041\311\206"
	"\125\214\170\342\015\025\153\273\163\135\223\203\067\143\120\323"
	"\035\357\376\167\046\372\224\163\216\006\334\137\375\132\060\272"
	"\073\275\206\160\350\117\003\323\362\052\307\165\003\343\117\326"
	"\067\116\367\375\071\303\032\014\302\170\136\160\363\012\014\111"
	"\041\073\004\376\051\364\366\224\143\362\175\145\116\061\063\337"
	"\140\063\164\046\361\043\057\276\271\272\246\134\265\207\156\335"
	"\134\100\253\133\243\042\344\222\075\150\023\024\031\055\154\223"
	"\031\115\046\156\072\300\303\324\027\364\125\010\106\320\373\376"
	"\075\240\352\212\010\145\140\253\217\233\317\353\337\027\356\154"
	"\172\246\161\236\042\310\121\037\203\032\014\137\004\134\075\172"
	"\146\251\371\363\107\326\201\146\221\235\307\156\230\344\210\216"
	"\235\105\073\200\241\344\134\154\347\221\122\333\004\054\277\033"
	"\243\142\376\244\004\025\126\004\322\064\136\037\123\317\030\331"
	"\172\150\154\317\200\254\103\357\275\075\151\075\330\313\100\067"
	"\173\047\201\024\243\330\201\210\303\044\061\357\171\232\115\347"
	"\232\363\063\151\317\245\012\276\226\145\064\153\261\014\302\175"
	"\373\340\030\202\303\277\062\061\013\317\045\231\063\273\014\205"
	"\141\146\133\140\334\115\175\356\074\031\115\356\135\105\217\044"
	"\173\171\150\304\051\301\116\313\047\203\322\360\006\075\324\347"
	"\102\343\314\042\237\170\066\200\251\254\306\014\120\256\253\303"
	"\251\207\114\122\365\107\116\235\155\226\276\016\374\043\230\041"
	"\263\072\313\341\241\345\347\267\102\347\150\302\342\113\303\151"
	"\356\271\230\336\150\140\054\210\046\351\007\227\310\244\154\007"
	"\357\350\337\217\163\024\366\117\226\031\066\020\212\226\073\320"
	"\311\025\211\170\246\024\166\103\154\147\274\054\120\322\376\340"
	"\062\175\176\241\167\314\035\103\271\215\322\253\312\172\346\230"
	"\216\066\353\134\335\044\357\271\021\215\046\365\207\300\002\234"
	"\003\044\275\273\330\252\141\072\301\136\074\151\004\273\101\221"
	"\364\277\362\025\244\165\220\226\310\053\104\333\217\055\274\332"
	"\274\173\260\124\054\113\220\366\022\006\143\111\230\075\301\320"
	"\131\077\277\011\032\156\225\060\263\227\231\307\114\127\135\045"
	"\040\157\031\326\122\071\355\046\210\054\311\330\344\120\243\367"
	"\310\132\151\142\245\342\055\214\321\044\270\136\312\346\302\066"
	"\341\073\221\170\112\274\174\332\116\321\036\376\373\075\040\325"
	"\345\146\145\077\304\235\046\057\310\135\352\224\171\371\307\211"
	"\163\254\051\057\245\050\361\022\305\064\100\265\154\066\237\104"
	"\050\361\336\074\164\056\326\006\026\153\177\172\332\322\133\127"
	"\137\344\040\370\241\065\210\116\263\145\147\040\145\306\213\222"
	"\344\364\300\307\213\166\177\237\332\271\321\300\220\161\012\314"
	"\246\305\103\103\372\316\166\370\170\175\271\334\316\023\355\225"
	"\335\001\200\167\332\244\132\050\033\071\173\214\016\016\373\153"
	"\037\247\173\021\257\114\242\237\257\140\107\315\175\247\072\176"
	"\333\152\333\214\064\035\343\140\176\163\366\344\005\266\021\232"
	"\213\020\334\245\140\110\205\311\374\265\045\043\074\045\074\226"
	"\324\050\063\153\167\300\304\014\072\035\255\363\126\345\015\164"
	"\361\330\312\336\363\222\250\136\205\317\321\331\047\306\033\025"
	"\135\205\244\241\276\370\103\137\102\301\200\042\113\203\253\173"
	"\135\247\053\063\247\270\253\200\050\210\257\165\341\366\207\262"
	"\306\054\225\156\310\034\357\272\334\076\337\120\264\250\326\015"
	"\050\056\263\204\204\362\115\007\251\231\002\261\224\344\216\326"
	"\010\222\145\346\353\156\174\043\306\032\154\274\347\125\100\133"
	"\015\002\055\253\372\202\052\355\100\305\325\174\371\235\031\240"
	"\055\126\207\030\304\003\074\212\036\250\107\006\376\207\141\013"
	"\211\217\267\203\021\342\161\121\247\106\316\241\344\347\101"
#define      msg1_z	65
#define      msg1	((&data[4762]))
	"\052\002\314\146\263\054\026\166\044\103\121\315\075\006\123\277"
	"\255\035\210\233\311\016\077\261\165\236\010\200\204\250\237\237"
	"\006\121\337\023\252\024\346\307\236\062\102\040\014\303\260\123"
	"\275\074\211\133\363\007\106\234\134\006\107\334\016\223\171\346"
	"\234\301\062\261\152\215\353\016\324\361\015\133\123\031\345\342"
	"\320\151"
#define      chk2_z	19
#define      chk2	((&data[4843]))
	"\105\132\041\357\330\271\057\324\317\321\203\232\164\276\326\245"
	"\376\321\326\325\050\276\023\373\005\373"
#define      inlo_z	3
#define      inlo	((&data[4866]))
	"\251\360\241"
#define      pswd_z	256
#define      pswd	((&data[4885]))
	"\323\247\310\277\266\235\261\303\371\004\334\336\346\254\107\332"
	"\243\324\035\026\215\137\332\244\103\066\020\113\116\220\226\162"
	"\206\132\366\112\051\251\203\150\371\351\107\124\153\365\116\017"
	"\312\153\045\130\312\377\374\016\065\015\132\203\235\360\366\044"
	"\113\354\157\165\226\362\335\220\334\045\344\107\033\062\126\346"
	"\236\174\076\151\173\072\167\261\110\321\065\345\302\053\011\015"
	"\030\170\203\257\153\141\077\107\206\043\216\241\125\345\207\364"
	"\141\306\135\335\001\324\216\111\246\303\056\151\357\067\167\010"
	"\260\372\267\033\133\366\142\341\031\361\203\157\327\013\143\070"
	"\321\300\025\323\225\244\034\074\150\112\245\127\202\034\137\063"
	"\027\026\116\162\015\261\124\046\243\330\225\172\343\371\263\265"
	"\271\311\210\117\155\245\213\325\360\061\055\163\116\214\246\145"
	"\243\365\327\260\246\054\327\112\004\155\304\347\146\167\235\040"
	"\100\046\157\256\313\373\204\273\055\261\056\173\076\324\340\342"
	"\312\270\222\161\344\152\273\350\327\177\320\076\367\155\136\070"
	"\223\316\347\136\312\153\032\367\035\110\162\133\035\122\076\347"
	"\012\321\130\357\073\023\327\023\223\247\121\213\025\257\304\250"
	"\137\042\037\271\103\063\265\111\056\362\140\147\371\241\243"
#define      tst2_z	19
#define      tst2	((&data[5157]))
	"\215\145\052\144\016\007\357\043\320\237\367\337\310\057\063\121"
	"\361\351\060\264\377\011"
#define      xecc_z	15
#define      xecc	((&data[5181]))
	"\102\236\340\321\143\275\024\107\270\050\210\036\373\167\134\166"
	"\060\277"
#define      date_z	1
#define      date	((&data[5196]))
	"\232"
#define      lsto_z	1
#define      lsto	((&data[5197]))
	"\252"
#define      chk1_z	22
#define      chk1	((&data[5200]))
	"\126\031\132\053\175\156\316\004\003\130\375\306\325\111\344\263"
	"\265\046\366\243\040\350\042\056\327\204\014"
#define      msg2_z	19
#define      msg2	((&data[5229]))
	"\332\217\323\043\342\224\056\045\147\272\273\231\175\007\333\054"
	"\174\246\075\074\067\036\014"
#define      rlax_z	1
#define      rlax	((&data[5248]))
	"\326"
#define      opts_z	1
#define      opts	((&data[5249]))
	"\060"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
